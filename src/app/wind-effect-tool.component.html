<div class="w-full h-full flex flex-col gap-3 text-gray-100 text-[11px]">
  <!-- Header / inputs -->
  <div class="flex items-end gap-3">
    <div class="flex-1">
      <label class="block text-[10px] text-gray-300 mb-0.5">
        Wind speed (mph)
      </label>
      <input
        type="number"
        [(ngModel)]="windSpeedMph"
        class="w-full bg-black border border-gray-700 rounded-xl px-2 py-1 text-[11px]"
        min="0"
        step="0.1"
      />
    </div>

    <div class="text-right text-[10px] leading-tight">
      <div class="text-gray-400">Wind direction</div>
      <div class="font-semibold text-gray-100">
        {{ windClock }} o'clock
      </div>
    </div>
  </div>

  <!-- Circle with draggable arrow -->
  <div
    #circleArea
    class="relative w-full max-w-xs mx-auto aspect-square select-none touch-none"
    (pointerdown)="startDrag($event)"
    (pointermove)="onDrag($event)"
    (pointerup)="endDrag($event)"
    (pointercancel)="endDrag($event)"
    (pointerleave)="endDrag($event)"
  >
    <svg viewBox="0 0 100 100" class="w-full h-full">
      <!-- Outer circle -->
      <circle
        cx="50"
        cy="50"
        r="40"
        class="fill-[#020617] stroke-gray-600"
        stroke-width="1.5"
      ></circle>

      <!-- Inner circle (impact zone) -->
      <circle
        cx="50"
        cy="50"
        r="22"
        class="fill-[#020617] stroke-gray-700"
        stroke-width="0.8"
      ></circle>

      <!-- Crosshair in the clock -->
      <line
        x1="50"
        y1="30"
        x2="50"
        y2="70"
        class="stroke-gray-600"
        stroke-width="0.6"
        stroke-linecap="round"
      ></line>
      <line
        x1="30"
        y1="50"
        x2="70"
        y2="50"
        class="stroke-gray-600"
        stroke-width="0.6"
        stroke-linecap="round"
      ></line>

      <!-- Hour ticks + labels -->
      <ng-container *ngFor="let h of hours">
        <line
          [attr.x1]="h.tickX1"
          [attr.y1]="h.tickY1"
          [attr.x2]="h.tickX2"
          [attr.y2]="h.tickY2"
          class="stroke-gray-500"
          stroke-width="0.6"
        ></line>
        <text
          [attr.x]="h.labelX"
          [attr.y]="h.labelY"
          text-anchor="middle"
          alignment-baseline="middle"
          class="fill-gray-300"
          style="font-size: 4.5px;"
        >
          {{ h.hour }}
        </text>
      </ng-container>

      <!-- Fat arrow on outer edge (draggable, pointing OUT from wind source) -->
      <g [attr.transform]="'rotate(' + arrowAngleDeg + ' 50 50)'">
        <!-- shaft from inner to outer edge -->
        <line
          x1="50"
          y1="20"
          x2="50"
          y2="7"
          class="stroke-orange-400"
          stroke-width="2.8"
          stroke-linecap="round"
        ></line>
        <!-- head pointing outward -->
        <polygon
          points="50,4 44,10 56,10"
          class="fill-orange-400"
        ></polygon>
      </g>

      <!-- Red POI dot (simple visual drift) -->
      <circle
        [attr.cx]="poiX"
        [attr.cy]="poiY"
        r="2.3"
        class="fill-red-500"
      ></circle>
    </svg>
  </div>

  <p class="text-[10px] text-gray-400 text-center px-4 leading-snug">
    Drag the orange arrow around the edge of the circle to set the
    wind <span class="font-semibold">source</span> direction.
    The arrow points away from where the wind is coming from.
  </p>

  <!-- Drift info column at bottom -->
  <div class="mt-1 grid grid-cols-2 gap-2 text-[10px]">
    <div class="bg-gray-900 rounded-xl px-2 py-1">
      <div class="text-gray-400">Drift (mil)</div>
      <div class="font-semibold text-gray-100">
        {{ milDrift | number : '1.2-2' }}
      </div>
      <div class="text-[9px] text-gray-500 mt-0.5">
        Full-value 10 mph â‰ˆ 1 mil
      </div>
    </div>
    <div class="bg-gray-900 rounded-xl px-2 py-1">
      <div class="text-gray-400">Drift (MOA)</div>
      <div class="font-semibold text-gray-100">
        {{ moaDrift | number : '1.2-2' }}
      </div>
      <div class="text-[9px] text-gray-500 mt-0.5">
        Based on {{ (milDrift | number:'1.2-2') }} mil
      </div>
    </div>
  </div>
</div>
