<div class="flex flex-col h-full w-full text-slate-200">

  <!-- Header / inputs -->
  <div class="mb-3 flex flex-col items-center gap-1">
    <div class="text-xs font-semibold uppercase tracking-wide">
      Wind effect visualiser
    </div>
    <div class="text-[10px] text-slate-400 text-center max-w-xs">
      Target is always at <span class="font-semibold text-slate-200">12 o'clock</span>.
      Set wind speed and drag the arrow around the circle. The red dot shows
      approximate point-of-impact shift from crosswind.
    </div>
  </div>

  <!-- Wind controls -->
  <div class="mb-3 flex items-center justify-center gap-4 text-xs">
    <label class="flex items-center gap-1">
      <span class="text-slate-300">Speed</span>
      <input
        type="number"
        min="0"
        step="0.5"
        [(ngModel)]="windSpeed"
        (ngModelChange)="computeImpact()"
        class="w-16 px-2 py-1 rounded bg-slate-900 border border-slate-600 text-center text-[11px]"
      />
      <span class="text-slate-400 text-[10px]">m/s</span>
    </label>

    <div class="flex flex-col text-[10px] text-slate-300">
      <span>
        Dir: <span class="font-semibold text-slate-100">{{ windClockLabel }}</span>
      </span>
      <span>
        Crosswind:
        <span class="font-semibold text-amber-400">{{ crosswindPercent }}%</span>
      </span>
    </div>
  </div>

  <!-- Circle / graphic -->
  <div class="flex-1 flex items-center justify-center">
    <div
      #circle
      class="relative"
      [style.width.px]="circleRadiusPx * 2"
      [style.height.px]="circleRadiusPx * 2"
      (click)="onCircleClick($event)"
    >
      <!-- Outer circle -->
      <div class="absolute inset-0 rounded-full border-2 border-slate-600"></div>

      <!-- Clock markers -->
      <div class="absolute left-1/2 -translate-x-1/2 -top-4 text-[10px]">12</div>
      <div class="absolute right-0 top-1/2 -translate-y-1/2 mr-[-8px] text-[10px]">3</div>
      <div class="absolute left-1/2 -translate-x-1/2 -bottom-4 text-[10px]">6</div>
      <div class="absolute left-0 top-1/2 -translate-y-1/2 ml-[-8px] text-[10px]">9</div>

      <!-- Arrow line (for feel) -->
      <div
        class="absolute left-1/2 top-1/2 origin-center border-t border-amber-300/70"
        [style.width.px]="circleRadiusPx"
        [style.transform]="'rotate(' + (windAngleDeg) + 'deg)'"
      ></div>

      <!-- Arrow handle (draggable) -->
      <div
        class="absolute w-4 h-4 bg-amber-300 rounded-full border border-black shadow-md cursor-pointer active:scale-110"
        [style.left]="'calc(50% + ' + arrowX + ' - 8px)'"
        [style.top]="'calc(50% + ' + arrowY + ' - 8px)'"
        (mousedown)="onHandleDown($event)"
        (touchstart)="onHandleDown($event)"
      ></div>

      <!-- Impact red dot -->
      <div
        class="absolute w-3 h-3 bg-red-500 rounded-full shadow"
        [style.left]="'calc(50% + ' + impactX + 'px - 6px)'"
        [style.top]="'calc(50% + ' + impactY + 'px - 6px)'"
      ></div>

      <!-- Center reference point -->
      <div
        class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-slate-300"
      ></div>
    </div>
  </div>

  <!-- Legend -->
  <div class="mt-3 text-[10px] text-slate-400 text-center px-2">
    <span class="inline-flex items-center gap-1 mr-3">
      <span class="w-2 h-2 rounded-full bg-amber-300 border border-black inline-block"></span>
      Wind FROM this direction
    </span>
    <span class="inline-flex items-center gap-1">
      <span class="w-2 h-2 rounded-full bg-red-500 inline-block"></span>
      Approximate POI shift on target
    </span>
  </div>
</div>
