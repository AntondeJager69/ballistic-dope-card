<div class="flex flex-col h-full text-xs text-gray-100">
  <!-- Top controls -->
  <div class="space-y-2">
    <!-- Rifle + distance row -->
    <div class="grid grid-cols-3 gap-2">
      <label class="flex flex-col">
        <span class="mb-0.5 text-[10px] text-gray-300">Rifle</span>
        <select
          class="w-full px-2 py-1 rounded bg-black border border-gray-700 text-[11px]"
          [(ngModel)]="selectedRifleId"
          (change)="onRifleChange()">
          <option [ngValue]="null">None</option>
          <option *ngFor="let r of rifles" [ngValue]="r.id">
            {{ r.name }}
          </option>
        </select>
      </label>

      <label class="flex flex-col">
        <span class="mb-0.5 text-[10px] text-gray-300">Distance</span>
        <div class="flex items-center gap-1">
          <input
            type="number"
            class="w-full px-2 py-1 rounded bg-black border border-gray-700 text-[11px]"
            [(ngModel)]="rangeMeters"
            (change)="onRangeChange()"
          />
          <span class="text-[10px] text-gray-400">m</span>
        </div>
      </label>

      <label class="flex flex-col">
        <span class="mb-0.5 text-[10px] text-gray-300">Wind (m/s)</span>
        <input
          type="number"
          class="w-full px-2 py-1 rounded bg-black border border-gray-700 text-[11px]"
          [(ngModel)]="windSpeedMps"
          (change)="onWindSpeedChange()"
        />
      </label>
    </div>

    <!-- Clock / direction row -->
    <div class="flex items-center gap-2">
      <span class="text-[10px] text-gray-400 w-14">Clock</span>
      <input
        type="range"
        min="1"
        max="12"
        [(ngModel)]="windClock"
        (change)="onWindClockChange()"
        class="flex-1"
      />
      <span class="text-[10px] text-gray-200 w-10 text-right">
        {{ windClock }}h
      </span>
    </div>

    <div class="text-[10px] text-gray-300 flex flex-wrap gap-x-3 gap-y-1">
      <span class="text-orange-300 font-semibold">
        {{ directionLabel }}
      </span>
      <span>Crosswind: {{ crosswindFactor | number:'1.2-2' }}</span>
      <span>Drift: {{ driftCm | number:'1.0-0' }} cm</span>
    </div>
  </div>

  <!-- Circle canvas -->
  <div class="flex-1 flex items-center justify-center mt-2">
    <div
      class="relative w-64 h-64"
      (mousedown)="onMouseDown($event)"
      (mousemove)="onMouseMove($event)"
      (mouseup)="onMouseUp()"
    >
      <canvas
        #circleCanvas
        width="220"
        height="220"
        class="absolute inset-0">
      </canvas>

      <canvas
        #impactCanvas
        width="220"
        height="220"
        class="absolute inset-0 pointer-events-none">
      </canvas>
    </div>
  </div>

  <!-- Holds row -->
  <div class="mt-3 grid grid-cols-3 gap-2 text-[10px]">
    <div class="bg-black/50 border border-gray-700 rounded-lg p-1.5">
      <div class="text-gray-400">Hold (mil)</div>
      <div class="text-sm font-semibold text-orange-300">
        {{ holdMil | number:'1.2-2' }}
      </div>
    </div>

    <div class="bg-black/50 border border-gray-700 rounded-lg p-1.5">
      <div class="text-gray-400">Hold (MOA)</div>
      <div class="text-sm font-semibold text-orange-300">
        {{ holdMoa | number:'1.2-2' }}
      </div>
    </div>

    <div class="bg-black/50 border border-gray-700 rounded-lg p-1.5">
      <div class="text-gray-400">Approx drift</div>
      <div class="text-sm font-semibold text-orange-300">
        {{ driftCm | number:'1.0-0' }} cm
      </div>
    </div>
  </div>

  <div class="mt-2 text-[9px] text-gray-400 leading-snug">
    This is an approximate visualiser only. Crosswind factor is based on the
    clock angle (12/6 = 0, 3/9 = 1). Adjust wind, distance and clock to see
    relative hold and drift. Rifle data can refine default distance and flight
    time per profile.
  </div>
</div>
