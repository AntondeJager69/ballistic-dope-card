<div class="flex flex-col h-full w-full text-slate-200">

  <!-- Header / instructions -->
  <div class="mb-3 flex flex-col items-center gap-1">
    <div class="text-xs font-semibold uppercase tracking-wide">
      Wind effect visualiser
    </div>
    <div class="text-[10px] text-slate-400 text-center max-w-xs">
      Target is always at
      <span class="font-semibold text-slate-200">12 o'clock</span>.
      Set wind and drag the arrow around the circle. The red dot shows
      approximate point-of-impact shift on the target.
    </div>
  </div>

  <!-- Wind controls -->
  <div class="mb-3 flex items-center justify-center gap-4 text-xs">
    <label class="flex flex-col items-center">
      <span class="text-[10px] text-slate-300 mb-1">Wind speed</span>
      <input
        type="number"
        class="w-20 bg-black border border-slate-600 rounded px-1 py-0.5 text-center text-[11px]"
        [(ngModel)]="windSpeed"
        (ngModelChange)="onWindSpeedChange($event)" />
      <span class="text-[9px] text-slate-500 mt-0.5">
        m/s or mph
      </span>
    </label>

    <label class="flex flex-col items-center">
      <span class="text-[10px] text-slate-300 mb-1">Wind from</span>
      <input
        type="number"
        min="1"
        max="12"
        class="w-16 bg-black border border-slate-600 rounded px-1 py-0.5 text-center text-[11px]"
        [(ngModel)]="windClock"
        (ngModelChange)="onWindClockChange()" />
      <span class="text-[9px] text-slate-500 mt-0.5">
        o'clock
      </span>
    </label>
  </div>

  <!-- Circle, arrow, POI -->
  <div class="flex-1 flex items-center justify-center">
    <div
      #circle
      class="relative"
      [style.width.px]="circleDiameter"
      [style.height.px]="circleDiameter"
      (pointerdown)="onCirclePointerDown($event)">

      <!-- Outer circle -->
      <div class="absolute inset-0 rounded-full border border-slate-600"></div>

      <!-- Crosshair -->
      <div class="absolute inset-x-1/2 -translate-x-1/2 top-0 bottom-0 border-l border-dashed border-slate-700"></div>
      <div class="absolute inset-y-1/2 -translate-y-1/2 left-0 right-0 border-t border-dashed border-slate-700"></div>

      <!-- Target notch at 12 o'clock -->
      <div class="absolute left-1/2 -translate-x-1/2 top-0">
        <div class="w-[10px] h-[4px] bg-slate-300 rounded-b"></div>
      </div>

      <!-- Wind arrow (from rim → centre) -->
      <div
        class="absolute left-1/2 top-1/2"
        [style.transform]="'translate(-50%, -50%) rotate(' + windAngleDeg + 'deg)'">
        <div class="flex flex-col items-center origin-[50%_10%]">
          <!-- Shaft -->
          <div
            class="w-[2px] bg-amber-300"
            [style.height.px]="circleDiameter / 2 - 18">
          </div>
          <!-- Arrow head pointing INWARDS -->
          <div
            class="w-0 h-0 border-l-[5px] border-r-[5px] border-t-[8px] border-l-transparent border-r-transparent border-t-amber-300">
          </div>
        </div>
      </div>

      <!-- POI shift (red dot) -->
      <div
        class="absolute left-1/2 top-1/2"
        [style.transform]="'translate(calc(-50% + ' + impactX + 'px), calc(-50% + ' + impactY + 'px))'">
        <div class="w-3 h-3 rounded-full bg-red-500 shadow"></div>
      </div>
    </div>
  </div>

  <!-- Crosswind summary -->
  <div class="mt-2 text-[10px] text-center text-slate-300">
    Crosswind component:
    <span class="font-semibold">{{ crosswindPercent }}%</span>
    of a pure 90° crosswind.
  </div>

  <!-- Legend -->
  <div class="mt-3 text-[10px] text-slate-400 text-center px-2">
    <span class="inline-flex items-center gap-1 mr-3">
      <!-- Arrow legend (replaces yellow dot) -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        class="w-3 h-3">
        <circle
          cx="12"
          cy="12"
          r="10"
          class="fill-transparent stroke-amber-300"
          stroke-width="1" />
        <path
          d="M12 4 L12 12 L8 8"
          class="stroke-amber-300"
          stroke-width="1.6"
          stroke-linecap="round"
          stroke-linejoin="round" />
      </svg>
      Wind FROM this direction
    </span>

    <span class="inline-flex items-center gap-1">
      <span class="w-2.5 h-2.5 rounded-full bg-red-500 inline-block"></span>
      Approximate POI shift on target
    </span>
  </div>
</div>
